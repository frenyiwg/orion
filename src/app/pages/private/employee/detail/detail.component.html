<!-- employee-detail.component.html -->
<section class="w-full">
  @if (loading()) {
    <!-- Loader -->
    <div class="rounded-2xl border border-neutral-200 bg-white p-6">
      <div class="flex items-center gap-3">
        <span
          class="inline-block h-5 w-5 rounded-full border-2 border-neutral-200 border-t-neutral-700 animate-spin"
          aria-label="Cargando"
        ></span>
        <p class="text-sm text-neutral-600">Cargando empleado...</p>
      </div>

      <!-- Skeleton -->
      <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-4">
        <div class="lg:col-span-1 rounded-xl border border-neutral-200 p-4">
          <div class="h-16 w-16 rounded-full bg-neutral-100"></div>
          <div class="mt-4 h-4 w-3/4 bg-neutral-100 rounded"></div>
          <div class="mt-2 h-3 w-1/2 bg-neutral-100 rounded"></div>
          <div class="mt-4 space-y-2">
            <div class="h-3 w-full bg-neutral-100 rounded"></div>
            <div class="h-3 w-5/6 bg-neutral-100 rounded"></div>
            <div class="h-3 w-4/6 bg-neutral-100 rounded"></div>
          </div>
        </div>

        <div class="lg:col-span-2 rounded-xl border border-neutral-200 p-4">
          <div class="h-4 w-1/3 bg-neutral-100 rounded"></div>
          <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3">
            <div class="h-10 bg-neutral-100 rounded"></div>
            <div class="h-10 bg-neutral-100 rounded"></div>
            <div class="h-10 bg-neutral-100 rounded"></div>
            <div class="h-10 bg-neutral-100 rounded"></div>
          </div>
          <div class="mt-6 h-4 w-1/4 bg-neutral-100 rounded"></div>
          <div class="mt-3 h-32 bg-neutral-100 rounded"></div>
        </div>
      </div>
    </div>
  } @else {
    @if (employee$ | async; as e) {
      <!-- Header / Profile -->
      <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
          <div class="flex items-center gap-4 min-w-0">
            <!-- Avatar -->
            <div
              class="h-14 w-14 sm:h-16 sm:w-16 rounded-full border border-neutral-200 bg-neutral-50 flex items-center justify-center overflow-hidden shrink-0"
            >
              <span class="text-lg sm:text-xl font-semibold text-neutral-600">
                {{ (e.personal.preferredName || e.personal.firstName).slice(0, 1)
                }}{{ e.personal.lastName.slice(0, 1) }}
              </span>
            </div>

            <!-- Identity -->
            <div class="min-w-0">
              <div class="flex flex-wrap items-center gap-2">
                <h1 class="text-lg sm:text-xl font-semibold text-neutral-900 truncate">
                  {{ e.personal.firstName + ' ' + e.personal.lastName }}
                </h1>

                <span
                  class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                >
                  {{ e.employeeCode }}
                </span>

                <span
                  class="text-xs rounded-full px-2 py-1 font-medium"
                  [ngClass]="{
                    'bg-emerald-50 text-emerald-700': e.status === 'ACTIVE',
                    'bg-amber-50 text-amber-700': e.status === 'ON_LEAVE',
                    'bg-neutral-100 text-neutral-700': e.status === 'INACTIVE',
                    'bg-rose-50 text-rose-700': e.status === 'TERMINATED',
                  }"
                >
                  {{ e.status }}
                </span>
              </div>

              <p class="text-sm text-neutral-600 truncate">
                {{ e.employment.position }} · {{ e.employment.department
                }}{{ e.employment.team ? ' · ' + e.employment.team : '' }}
              </p>

              <p class="text-xs text-neutral-500 truncate">
                {{ e.employment.company }} · {{ e.employment.workMode }} ·
                {{ e.employment.location.name }} ({{ e.employment.location.country }})
              </p>
            </div>
          </div>

          <!-- Actions -->
          <div class="flex flex-wrap gap-2 sm:justify-end">
            <a
              class="inline-flex items-center justify-center rounded-lg border border-neutral-200 px-3 py-2 text-sm font-medium text-neutral-700 hover:bg-neutral-50"
              [routerLink]="['../../editar', e.id]"
            >
              Editar
            </a>
            <a
              class="inline-flex items-center justify-center rounded-lg bg-neutral-900 px-3 py-2 text-sm font-medium text-white hover:opacity-90"
              [routerLink]="['../']"
            >
              Volver
            </a>
          </div>
        </div>
      </div>

      <!-- Content grid -->
      <div class="mt-4 grid grid-cols-1 lg:grid-cols-3 gap-4">
        <!-- Left column -->
        <div class="lg:col-span-1 flex flex-col gap-4">
          <!-- Personal -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <h2 class="text-sm font-semibold text-neutral-900">Información personal</h2>

            <div class="mt-4 space-y-3 text-sm">
              <div class="flex items-start justify-between gap-3">
                <span class="text-neutral-500">Nombre legal</span>
                <span class="text-neutral-900 text-right">
                  {{ e.personal.firstName }}
                  {{ e.personal.middleName ? e.personal.middleName : '' }}
                  {{ e.personal.lastName }}
                  {{ e.personal.secondLastName ? e.personal.secondLastName : '' }}
                </span>
              </div>

              <div class="flex items-start justify-between gap-3">
                <span class="text-neutral-500">Género</span>
                <span class="text-neutral-900">{{ e.personal.gender }}</span>
              </div>

              <div class="flex items-start justify-between gap-3">
                <span class="text-neutral-500">Estado civil</span>
                <span class="text-neutral-900">{{ e.personal.maritalStatus }}</span>
              </div>

              <div class="flex items-start justify-between gap-3">
                <span class="text-neutral-500">Nacimiento</span>
                <span class="text-neutral-900">{{ e.personal.birthDate }}</span>
              </div>

              <div class="flex items-start justify-between gap-3">
                <span class="text-neutral-500">Nacionalidad</span>
                <span class="text-neutral-900">{{ e.personal.nationality }}</span>
              </div>

              <div class="pt-3 border-t border-neutral-200">
                <div class="flex items-start justify-between gap-3">
                  <span class="text-neutral-500">Identificación</span>
                  <span class="text-neutral-900 text-right">
                    {{ e.personal.identification.type }} · {{ e.personal.identification.number }}
                  </span>
                </div>

                <div class="mt-2 flex items-start justify-between gap-3">
                  <span class="text-neutral-500">País emisión</span>
                  <span class="text-neutral-900">{{
                    e.personal.identification.issuedCountry
                  }}</span>
                </div>

                <div class="mt-2 flex items-start justify-between gap-3">
                  <span class="text-neutral-500">Expira</span>
                  <span class="text-neutral-900">{{
                    e.personal.identification.expiresAt || '—'
                  }}</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Contact -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <h2 class="text-sm font-semibold text-neutral-900">Contacto</h2>

            <div class="mt-4 space-y-4 text-sm">
              <div>
                <p class="text-xs font-medium text-neutral-500">Emails</p>
                <div class="mt-2 space-y-2">
                  @if (e.contact.emails.length > 0) {
                    @for (m of e.contact.emails; track m.value) {
                      <div class="flex items-center justify-between gap-3">
                        <span class="text-neutral-900 truncate">{{ m.value }}</span>
                        <span
                          class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                        >
                          {{ m.type }}{{ m.isPrimary ? ' · PRIMARY' : '' }}
                        </span>
                      </div>
                    }
                  } @else {
                    <p class="text-neutral-500">—</p>
                  }
                </div>
              </div>

              <div>
                <p class="text-xs font-medium text-neutral-500">Teléfonos</p>
                <div class="mt-2 space-y-2">
                  @if (e.contact.phones.length > 0) {
                    @for (
                      p of e.contact.phones;
                      track p.countryCode + p.number + (p.ext ?? '') + p.type
                    ) {
                      <div class="flex items-center justify-between gap-3">
                        <span class="text-neutral-900 truncate">
                          {{ p.countryCode }} {{ p.number }}{{ p.ext ? ' ext ' + p.ext : '' }}
                        </span>
                        <span
                          class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                        >
                          {{ p.type }}{{ p.isPrimary ? ' · PRIMARY' : '' }}
                        </span>
                      </div>
                    }
                  } @else {
                    <p class="text-neutral-500">—</p>
                  }
                </div>
              </div>

              <div class="pt-3 border-t border-neutral-200">
                <div class="flex items-start justify-between gap-3">
                  <span class="text-neutral-500">Idioma</span>
                  <span class="text-neutral-900">{{ e.contact.preferredLanguage || '—' }}</span>
                </div>

                <div class="mt-2 flex items-start justify-between gap-3">
                  <span class="text-neutral-500">Zona horaria</span>
                  <span class="text-neutral-900">{{ e.contact.timeZone || '—' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column -->
        <div class="lg:col-span-2 flex flex-col gap-4">
          <!-- Employment -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <h2 class="text-sm font-semibold text-neutral-900">Información laboral</h2>

            <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Empresa</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.company }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Posición</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.position }}</p>
                <p class="mt-1 text-xs text-neutral-500">{{ e.employment.jobLevel || '—' }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Departamento</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.department }}</p>
                <p class="mt-1 text-xs text-neutral-500">{{ e.employment.team || '—' }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Tipo / Modalidad</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.employmentType }}</p>
                <p class="mt-1 text-xs text-neutral-500">{{ e.employment.workMode }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Contratación</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.hireDate }}</p>
                <p class="mt-1 text-xs text-neutral-500">
                  Termina: {{ e.employment.terminationDate || '—' }}
                </p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Sede</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.employment.location.name }}</p>
                <p class="mt-1 text-xs text-neutral-500">{{ e.employment.location.country }}</p>
              </div>
            </div>

            <div class="mt-4 rounded-xl border border-neutral-200 p-4">
              <p class="text-xs text-neutral-500">Horario</p>
              <div
                class="mt-2 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm"
              >
                <p class="text-neutral-900">
                  {{ e.employment.schedule.shift }} ·
                  {{ e.employment.schedule.weeklyHours }}h/semana
                </p>
                <div class="flex flex-wrap gap-2">
                  @for (d of e.employment.schedule.workDays; track d) {
                    <span
                      class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                      >{{ d }}</span
                    >
                  }
                </div>
              </div>

              @if (e.employment.leave) {
                <div class="mt-3 pt-3 border-t border-neutral-200">
                  <p class="text-xs text-neutral-500">Licencia</p>
                  <p class="mt-1 text-sm text-neutral-900">
                    {{ e.employment.leave.type }} · {{ e.employment.leave.startDate
                    }}{{ e.employment.leave.endDate ? ' → ' + e.employment.leave.endDate : '' }}
                  </p>
                  <p class="mt-1 text-xs text-neutral-500">{{ e.employment.leave.notes || '' }}</p>
                </div>
              }
            </div>
          </div>

          <!-- Compensation -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <h2 class="text-sm font-semibold text-neutral-900">Compensación</h2>

            <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Salario base</p>
                <p class="mt-1 font-medium text-neutral-900">
                  {{ e.compensation.currency }} {{ e.compensation.baseSalary | number: '1.0-0' }}
                </p>
                <p class="mt-1 text-xs text-neutral-500">{{ e.compensation.payFrequency }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Bono</p>
                <p class="mt-1 font-medium text-neutral-900">
                  {{ e.compensation.bonusEligible ? 'Elegible' : 'No elegible' }}
                </p>
                <p class="mt-1 text-xs text-neutral-500">
                  Target:
                  {{
                    e.compensation.bonusEligible
                      ? (e.compensation.bonusTargetPercent ?? 0) + '%'
                      : '—'
                  }}
                </p>
              </div>
            </div>

            <div class="mt-4 rounded-xl border border-neutral-200 overflow-hidden">
              <div class="px-4 py-3 bg-neutral-50 border-b border-neutral-200">
                <p class="text-sm font-medium text-neutral-900">Cuentas bancarias</p>
              </div>

              <div class="divide-y divide-neutral-200">
                @if (e.compensation.bankAccounts.length > 0) {
                  @for (b of e.compensation.bankAccounts; track b.id) {
                    <div
                      class="p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2"
                    >
                      <div class="min-w-0">
                        <p class="font-medium text-neutral-900 truncate">
                          {{ b.bankName }} · {{ b.accountType }}
                          @if (b.isPrimary) {
                            <span
                              class="ml-2 text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                              >PRIMARY</span
                            >
                          }
                        </p>
                        <p class="text-xs text-neutral-500">{{ b.accountNumberMasked }}</p>
                      </div>
                    </div>
                  }
                } @else {
                  <div class="p-4 text-sm text-neutral-500">—</div>
                }
              </div>
            </div>
          </div>

          <!-- Addresses table -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <div class="flex items-center justify-between gap-3">
              <h2 class="text-sm font-semibold text-neutral-900">Direcciones</h2>
              <span
                class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
              >
                {{ e.addresses.length || 0 }}
              </span>
            </div>

            <div class="mt-4 w-full overflow-x-auto rounded-xl border border-neutral-200 bg-white">
              <table class="min-w-225 w-full text-sm">
                <thead class="bg-neutral-50 text-neutral-700">
                  <tr class="border-b border-neutral-200">
                    <th class="px-4 py-3 text-left font-medium">Tipo</th>
                    <th class="px-4 py-3 text-left font-medium">Label</th>
                    <th class="px-4 py-3 text-left font-medium">Dirección</th>
                    <th class="px-4 py-3 text-left font-medium">Ciudad</th>
                    <th class="px-4 py-3 text-left font-medium">País</th>
                    <th class="px-4 py-3 text-left font-medium">Vigencia</th>
                    <th class="px-4 py-3 text-left font-medium">Primary</th>
                  </tr>
                </thead>

                <tbody class="divide-y divide-neutral-200">
                  @if (e.addresses.length > 0) {
                    @for (a of e.addresses; track a.id) {
                      <tr class="hover:bg-neutral-50">
                        <td class="px-4 py-3">
                          <span
                            class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                          >
                            {{ a.type }}
                          </span>
                        </td>
                        <td class="px-4 py-3 text-neutral-800">
                          {{ a.label || '—' }}
                        </td>
                        <td class="px-4 py-3 text-neutral-800">
                          {{ a.line1 }}{{ a.line2 ? ', ' + a.line2 : '' }}
                          @if (a.sector) {
                            <span class="text-neutral-500"> · {{ a.sector }}</span>
                          }
                        </td>
                        <td class="px-4 py-3 text-neutral-800">
                          {{ a.city }}{{ a.state ? ', ' + a.state : '' }}
                          @if (a.postalCode) {
                            <span class="text-neutral-500"> · {{ a.postalCode }}</span>
                          }
                        </td>
                        <td class="px-4 py-3 text-neutral-800">{{ a.country }}</td>
                        <td class="px-4 py-3 text-neutral-800">
                          {{ a.validFrom || '—' }} → {{ a.validTo || '—' }}
                        </td>
                        <td class="px-4 py-3">
                          @if (a.isPrimary) {
                            <span
                              class="text-xs rounded-full px-2 py-1 bg-emerald-50 text-emerald-700"
                              >Sí</span
                            >
                          } @else {
                            <span
                              class="text-xs rounded-full px-2 py-1 bg-neutral-100 text-neutral-700"
                              >No</span
                            >
                          }
                        </td>
                      </tr>
                    }
                  } @else {
                    <tr>
                      <td class="px-4 py-4 text-neutral-500" colspan="7">
                        Este empleado no tiene direcciones registradas.
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>

            @if (e.addresses.length > 0) {
              <!-- Mobile-friendly list (optional, shown only on small screens) -->
              <div class="mt-4 grid grid-cols-1 gap-3 md:hidden">
                @for (a of e.addresses; track a.id) {
                  <div class="rounded-xl border border-neutral-200 p-4 bg-white">
                    <div class="flex items-center justify-between">
                      <span
                        class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                        >{{ a.type }}</span
                      >
                      @if (a.isPrimary) {
                        <span class="text-xs rounded-full px-2 py-1 bg-emerald-50 text-emerald-700"
                          >Primary</span
                        >
                      }
                    </div>
                    <p class="mt-2 text-sm font-medium text-neutral-900">
                      {{ a.line1 }}{{ a.line2 ? ', ' + a.line2 : '' }}
                    </p>
                    <p class="text-xs text-neutral-500">
                      {{ a.city }}{{ a.state ? ', ' + a.state : '' }} · {{ a.country }}
                    </p>
                    <p class="mt-2 text-xs text-neutral-500">
                      Vigencia: {{ a.validFrom || '—' }} → {{ a.validTo || '—' }}
                    </p>
                    @if (a.notes) {
                      <p class="mt-2 text-xs text-neutral-500">{{ a.notes }}</p>
                    }
                  </div>
                }
              </div>
            }
          </div>

          <!-- Benefits / Emergency / Docs / Assets / Permissions -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Benefits -->
            <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
              <h2 class="text-sm font-semibold text-neutral-900">Beneficios</h2>

              @if (e.benefits) {
                <div class="mt-4 space-y-3 text-sm">
                  <div class="rounded-xl border border-neutral-200 p-4">
                    <p class="text-xs text-neutral-500">Seguro</p>
                    <p class="mt-1 font-medium text-neutral-900">
                      {{ e.benefits.healthPlan?.provider || '—' }}
                    </p>
                    <p class="text-xs text-neutral-500">
                      {{ e.benefits.healthPlan?.planName || '—' }} ·
                      {{ e.benefits.healthPlan?.memberId || '—' }}
                    </p>
                  </div>

                  <div class="rounded-xl border border-neutral-200 p-4">
                    <p class="text-xs text-neutral-500">Pensión</p>
                    <p class="mt-1 font-medium text-neutral-900">
                      {{ e.benefits.pension?.provider || '—' }}
                    </p>
                    <p class="text-xs text-neutral-500">
                      {{ e.benefits.pension?.memberId || '—' }}
                    </p>
                  </div>
                </div>
              } @else {
                <p class="mt-4 text-sm text-neutral-500">—</p>
              }
            </div>

            <!-- Emergency -->
            <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
              <h2 class="text-sm font-semibold text-neutral-900">Contactos de emergencia</h2>

              <div class="mt-4 space-y-3 text-sm">
                @if (e.emergencyContacts?.length) {
                  @for (c of e.emergencyContacts; track c.name + c.phone.number) {
                    <div class="rounded-xl border border-neutral-200 p-4">
                      <div class="flex items-center justify-between gap-2">
                        <p class="font-medium text-neutral-900 truncate">{{ c.name }}</p>
                        @if (c.isPrimary) {
                          <span
                            class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                            >PRIMARY</span
                          >
                        }
                      </div>
                      <p class="text-xs text-neutral-500">{{ c.relationship }}</p>
                      <p class="mt-2 text-sm text-neutral-900">
                        {{ c.phone.countryCode }} {{ c.phone.number }}
                      </p>
                      <p class="text-xs text-neutral-500">{{ c.email || '—' }}</p>
                    </div>
                  }
                } @else {
                  <p class="text-sm text-neutral-500">—</p>
                }
              </div>
            </div>
          </div>

          <!-- Documents + Assets + Permissions -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
            <!-- Documents -->
            <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
              <h2 class="text-sm font-semibold text-neutral-900">Documentos</h2>

              <div class="mt-4 space-y-2 text-sm">
                @if (e.documents?.length) {
                  @for (d of e.documents; track d.fileName + d.type) {
                    <div
                      class="flex items-start justify-between gap-3 rounded-xl border border-neutral-200 p-3"
                    >
                      <div class="min-w-0">
                        <p class="font-medium text-neutral-900 truncate">{{ d.type }}</p>
                        <p class="text-xs text-neutral-500 truncate">{{ d.fileName }}</p>
                      </div>
                      <span
                        class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                      >
                        {{ d.status }}
                      </span>
                    </div>
                  }
                } @else {
                  <p class="text-sm text-neutral-500">—</p>
                }
              </div>
            </div>

            <!-- Assets -->
            <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
              <h2 class="text-sm font-semibold text-neutral-900">Activos</h2>

              <div class="mt-4 space-y-2 text-sm">
                @if (e.assets?.length) {
                  @for (a of e.assets; track a.tag + a.type) {
                    <div
                      class="flex items-start justify-between gap-3 rounded-xl border border-neutral-200 p-3"
                    >
                      <div class="min-w-0">
                        <p class="font-medium text-neutral-900 truncate">{{ a.type }}</p>
                        <p class="text-xs text-neutral-500 truncate">
                          {{ a.tag }}{{ a.model ? ' · ' + a.model : '' }}
                        </p>
                      </div>
                      <p class="text-xs text-neutral-500">{{ a.assignedAt || '—' }}</p>
                    </div>
                  }
                } @else {
                  <p class="text-sm text-neutral-500">—</p>
                }
              </div>
            </div>

            <!-- Permissions -->
            <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
              <h2 class="text-sm font-semibold text-neutral-900">Permisos</h2>

              @if (e.permissions) {
                <div class="mt-4 space-y-3 text-sm">
                  <div>
                    <p class="text-xs font-medium text-neutral-500">Roles</p>
                    <div class="mt-2 flex flex-wrap gap-2">
                      @if (e.permissions.roles.length > 0) {
                        @for (r of e.permissions.roles; track r) {
                          <span
                            class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                            >{{ r }}</span
                          >
                        }
                      } @else {
                        <span class="text-sm text-neutral-500">—</span>
                      }
                    </div>
                  </div>

                  <div class="pt-3 border-t border-neutral-200">
                    <p class="text-xs font-medium text-neutral-500">Sistemas</p>
                    <div class="mt-2 space-y-2">
                      @if (e.permissions.systems.length) {
                        @for (s of e.permissions.systems; track s.name) {
                          <div
                            class="flex items-center justify-between gap-2 rounded-xl border border-neutral-200 p-3"
                          >
                            <span class="text-sm text-neutral-900">{{ s.name }}</span>
                            <span
                              class="text-xs rounded-full px-2 py-1 border border-neutral-200 text-neutral-600"
                              >{{ s.access }}</span
                            >
                          </div>
                        }
                      } @else {
                        <p class="text-sm text-neutral-500">—</p>
                      }
                    </div>
                  </div>
                </div>
              } @else {
                <p class="mt-4 text-sm text-neutral-500">—</p>
              }
            </div>
          </div>

          <!-- Audit -->
          <div class="rounded-2xl border border-neutral-200 bg-white p-4 sm:p-6">
            <h2 class="text-sm font-semibold text-neutral-900">Auditoría</h2>

            <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Creado</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.audit.createdAt }}</p>
                <p class="text-xs text-neutral-500">{{ e.audit.createdBy }}</p>
              </div>

              <div class="rounded-xl border border-neutral-200 p-4">
                <p class="text-xs text-neutral-500">Actualizado</p>
                <p class="mt-1 font-medium text-neutral-900">{{ e.audit.updatedAt || '—' }}</p>
                <p class="text-xs text-neutral-500">{{ e.audit.updatedBy || '—' }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    } @else {
      <div class="rounded-2xl border border-neutral-200 bg-white p-6">
        <p class="text-sm text-neutral-600">No se encontró el empleado.</p>
      </div>
    }
  }
</section>
